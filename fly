-- may not work, bc i am lazy to bypass this anticheat, so it made by ai


local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")

local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()

getgenv().FlyEnabled = false
getgenv().FlySpeed = 50

local function AntiFling()
    local Character = LocalPlayer.Character
    if Character and Character:FindFirstChild("HumanoidRootPart") then
        local HRP = Character.HumanoidRootPart
        HRP.Velocity = Vector3.new(0, 0, 0)
        HRP.AssemblyLinearVelocity = Vector3.new(0, 0, 0)
        HRP.AssemblyAngularVelocity = Vector3.new(0, 0, 0)
    end
end

local function ToggleFly()
    getgenv().FlyEnabled = not getgenv().FlyEnabled
    
    local Character = LocalPlayer.Character
    if not Character or not Character:FindFirstChild("Humanoid") then return end
    
    local Humanoid = Character.Humanoid
    local RootPart = Character:FindFirstChild("HumanoidRootPart")
    
    if getgenv().FlyEnabled and RootPart then
        local BodyVelocity = Instance.new("BodyVelocity")
        BodyVelocity.MaxForce = Vector3.new(4000, 4000, 4000)
        BodyVelocity.Velocity = Vector3.new(0, 0, 0)
        BodyVelocity.Parent = RootPart
        
        local BodyAngularVelocity = Instance.new("BodyAngularVelocity")
        BodyAngularVelocity.MaxTorque = Vector3.new(4000, 4000, 4000)
        BodyAngularVelocity.AngularVelocity = Vector3.new(0, 0, 0)
        BodyAngularVelocity.Parent = RootPart
        
        Humanoid.PlatformStand = true
        
        RunService.Heartbeat:Connect(function()
            if getgenv().FlyEnabled and RootPart and RootPart.Parent then
                AntiFling()
                
                local Camera = workspace.CurrentCamera
                local MoveVector = Humanoid.MoveDirection
                
                if UserInputService:IsKeyDown(Enum.KeyCode.Space) then
                    BodyVelocity.Velocity = RootPart.CFrame.LookVector * getgenv().FlySpeed
                elseif UserInputService:IsKeyDown(Enum.KeyCode.LeftShift) then
                    BodyVelocity.Velocity = -RootPart.CFrame.LookVector * getgenv().FlySpeed
                else
                    BodyVelocity.Velocity = Vector3.new(
                        (UserInputService:IsKeyDown(Enum.KeyCode.A) and -getgenv().FlySpeed or 0) +
                        (UserInputService:IsKeyDown(Enum.KeyCode.D) and getgenv().FlySpeed or 0),
                        (UserInputService:IsKeyDown(Enum.KeyCode.Space) and getgenv().FlySpeed or 0) +
                        (UserInputService:IsKeyDown(Enum.KeyCode.LeftShift) and -getgenv().FlySpeed or 0),
                        (UserInputService:IsKeyDown(Enum.KeyCode.W) and getgenv().FlySpeed or 0) +
                        (UserInputService:IsKeyDown(Enum.KeyCode.S) and -getgenv().FlySpeed or 0)
                    )
                end
            end
        end)
    else
        Humanoid.PlatformStand = false
        if Character:FindFirstChild("BodyVelocity") then
            Character.BodyVelocity:Destroy()
        end
        if Character:FindFirstChild("BodyAngularVelocity") then
            Character.BodyAngularVelocity:Destroy()
        end
    end
end

UserInputService.InputBegan:Connect(function(input, processed)
    if processed then return end
    if input.KeyCode == Enum.KeyCode.F then
        ToggleFly()
    end
end)

spawn(function()
    while wait(0.1) do
        AntiFling()
    end
end
